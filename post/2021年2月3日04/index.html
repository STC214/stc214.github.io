<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://stc214.github.io/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://stc214.github.io/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://stc214.github.io/css/github.min.css' />
    <link rel="stylesheet" href='https://stc214.github.io/css/github-style.css' />
    <link rel="stylesheet" href='https://stc214.github.io/css/light.css' />
    <link rel="stylesheet" href='https://stc214.github.io/css/dark.css' />
    <link rel="stylesheet" href='https://stc214.github.io/css/syntax.css' />
    <title>docker 拷贝镜像文件 - NOTE</title>
    
    <link rel="icon" type="image/x-icon" href='/images/github.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="原文：https://www.cnblogs.com/bigben0123/p/7592970.html
1、概述
我们制作好镜像后，有时需要将镜像复制到另一台服务器使用。
能达到以上目的有两种方式，一种是上传镜像到仓库中（本地或公共仓库），但是另一台服务器很肯能只是与当前服务器局域网想通而没有公网的，所以如果使用仓库的方式，只能自己搭建私有仓库，这会在另一篇文章中介绍。
如果我们仅仅是要复制到另外少数的服务器，搭建私有仓库显然没有这个必要，而将镜像保存为文件上传到其他服务器再从文件中载入镜像也是一个不错的选择。
可以使用Docker save和Docker load命令来存储和载入镜像。
2、保存镜像为文件
如果要讲镜像保存为本地文件，可以使用Docker save命令。
命令格式：
docker save -o 要保存的文件名 要保存的镜像
首先查看当前的镜像列表：
docker images
比如这里,我们将java8的镜像保存为文件：
docker save -o java8.tar lwieske/java-8
完成后通过 ls 命令即可看到文件。
3、从文件载入镜像
从文件载入镜像可以使用Docker load命令。
命令格式：
docker load &amp;ndash;input 文件
或者
docker load &amp;lt; 文件名
此时会导入镜像以及相关的元数据信息等。
首先使用SSH工具将文件上传到另一台服务器。
然后通过命令载入镜像：
docker load &amp;lt; java8.tar
导入后可以使用docker images命令查看:
docker images
原文链接：http://blog.csdn.net/anxpp/article/details/51810776
Docker 创建镜像、修改、上传镜像
–创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。
一、创建镜像
创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。
二、修改已有镜像
1、先使用下载的镜像启动容器。
$ docker run -t -i training/sinatra /bin/bash root@0b2616b0e5a8:/#" />
<meta name="keywords"
  content='blog, google analytics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://stc214.github.io/post/2021%E5%B9%B42%E6%9C%883%E6%97%A504/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="docker 拷贝镜像文件 - NOTE" />
<meta name="twitter:description"
  content="原文：https://www.cnblogs.com/bigben0123/p/7592970.html
1、概述
我们制作好镜像后，有时需要将镜像复制到另一台服务器使用。
能达到以上目的有两种方式，一种是上传镜像到仓库中（本地或公共仓库），但是另一台服务器很肯能只是与当前服务器局域网想通而没有公网的，所以如果使用仓库的方式，只能自己搭建私有仓库，这会在另一篇文章中介绍。
如果我们仅仅是要复制到另外少数的服务器，搭建私有仓库显然没有这个必要，而将镜像保存为文件上传到其他服务器再从文件中载入镜像也是一个不错的选择。
可以使用Docker save和Docker load命令来存储和载入镜像。
2、保存镜像为文件
如果要讲镜像保存为本地文件，可以使用Docker save命令。
命令格式：
docker save -o 要保存的文件名 要保存的镜像
首先查看当前的镜像列表：
docker images
比如这里,我们将java8的镜像保存为文件：
docker save -o java8.tar lwieske/java-8
完成后通过 ls 命令即可看到文件。
3、从文件载入镜像
从文件载入镜像可以使用Docker load命令。
命令格式：
docker load &amp;ndash;input 文件
或者
docker load &amp;lt; 文件名
此时会导入镜像以及相关的元数据信息等。
首先使用SSH工具将文件上传到另一台服务器。
然后通过命令载入镜像：
docker load &amp;lt; java8.tar
导入后可以使用docker images命令查看:
docker images
原文链接：http://blog.csdn.net/anxpp/article/details/51810776
Docker 创建镜像、修改、上传镜像
–创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。
一、创建镜像
创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。
二、修改已有镜像
1、先使用下载的镜像启动容器。
$ docker run -t -i training/sinatra /bin/bash root@0b2616b0e5a8:/#" />
<meta name="twitter:site" content="https://stc214.github.io/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://stc214.github.io/img/0040.jpg">


<meta property="og:type" content="article" />
<meta property="og:title" content="docker 拷贝镜像文件 - NOTE">
<meta property="og:description"
  content="原文：https://www.cnblogs.com/bigben0123/p/7592970.html
1、概述
我们制作好镜像后，有时需要将镜像复制到另一台服务器使用。
能达到以上目的有两种方式，一种是上传镜像到仓库中（本地或公共仓库），但是另一台服务器很肯能只是与当前服务器局域网想通而没有公网的，所以如果使用仓库的方式，只能自己搭建私有仓库，这会在另一篇文章中介绍。
如果我们仅仅是要复制到另外少数的服务器，搭建私有仓库显然没有这个必要，而将镜像保存为文件上传到其他服务器再从文件中载入镜像也是一个不错的选择。
可以使用Docker save和Docker load命令来存储和载入镜像。
2、保存镜像为文件
如果要讲镜像保存为本地文件，可以使用Docker save命令。
命令格式：
docker save -o 要保存的文件名 要保存的镜像
首先查看当前的镜像列表：
docker images
比如这里,我们将java8的镜像保存为文件：
docker save -o java8.tar lwieske/java-8
完成后通过 ls 命令即可看到文件。
3、从文件载入镜像
从文件载入镜像可以使用Docker load命令。
命令格式：
docker load &amp;ndash;input 文件
或者
docker load &amp;lt; 文件名
此时会导入镜像以及相关的元数据信息等。
首先使用SSH工具将文件上传到另一台服务器。
然后通过命令载入镜像：
docker load &amp;lt; java8.tar
导入后可以使用docker images命令查看:
docker images
原文链接：http://blog.csdn.net/anxpp/article/details/51810776
Docker 创建镜像、修改、上传镜像
–创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。
一、创建镜像
创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。
二、修改已有镜像
1、先使用下载的镜像启动容器。
$ docker run -t -i training/sinatra /bin/bash root@0b2616b0e5a8:/#" />
<meta property="og:url" content="https://stc214.github.io/post/2021%E5%B9%B42%E6%9C%883%E6%97%A504/" />
<meta property="og:site_name" content="docker 拷贝镜像文件" />
<meta property="og:image"
  content="https://stc214.github.io/img/0040.jpg">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2021-02-03 02:21:40 &#43;0800 CST" />










</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://stc214.github.io/">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://stc214.github.io/">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://stc214.github.io/">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
          width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://stc214.github.io/">
                  <img class=" avatar-user"
                    src="https://stc214.github.io/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://stc214.github.io/">STC214</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://stc214.github.io/post/2021%E5%B9%B42%E6%9C%883%E6%97%A504/">docker 拷贝镜像文件</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Wed, 03 Feb 2021 02:21:40 &#43;0800"
                    class="no-wrap">
                    Wed, 03 Feb 2021 02:21:40 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Wed, 03 Feb 2021 02:21:40 &#43;0800"
                    class="no-wrap">
                    Wed, 03 Feb 2021 02:21:40 &#43;0800</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      2017 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/note">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      Note
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/%E7%AC%94%E8%AE%B0">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      笔记
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p>原文：https://www.cnblogs.com/bigben0123/p/7592970.html</p>
<p>1、概述</p>
<p>我们制作好镜像后，有时需要将镜像复制到另一台服务器使用。</p>
<p>能达到以上目的有两种方式，一种是上传镜像到仓库中（本地或公共仓库），但是另一台服务器很肯能只是与当前服务器局域网想通而没有公网的，所以如果使用仓库的方式，只能自己搭建私有仓库，这会在另一篇文章中介绍。</p>
<p>如果我们仅仅是要复制到另外少数的服务器，搭建私有仓库显然没有这个必要，而将镜像保存为文件上传到其他服务器再从文件中载入镜像也是一个不错的选择。</p>
<p>可以使用Docker save和Docker load命令来存储和载入镜像。</p>
<p>2、保存镜像为文件</p>
<p>如果要讲镜像保存为本地文件，可以使用Docker save命令。</p>
<p>命令格式：</p>
<blockquote>
<p>docker save -o 要保存的文件名  要保存的镜像</p>
</blockquote>
<p>首先查看当前的镜像列表：</p>
<blockquote>
<p>docker images</p>
</blockquote>
<p>比如这里,我们将java8的镜像保存为文件：</p>
<blockquote>
<p>docker save -o java8.tar lwieske/java-8</p>
</blockquote>
<p>完成后通过 ls 命令即可看到文件。</p>
<p>3、从文件载入镜像</p>
<p>从文件载入镜像可以使用Docker load命令。</p>
<p>命令格式：</p>
<blockquote>
<p>docker load &ndash;input 文件</p>
</blockquote>
<p>或者</p>
<blockquote>
<p>docker load &lt; 文件名</p>
</blockquote>
<p>此时会导入镜像以及相关的元数据信息等。</p>
<p>首先使用SSH工具将文件上传到另一台服务器。</p>
<p>然后通过命令载入镜像：</p>
<blockquote>
<p>docker load &lt; java8.tar</p>
</blockquote>
<p>导入后可以使用docker images命令查看:</p>
<blockquote>
<p>docker images</p>
</blockquote>
<p>原文链接：http://blog.csdn.net/anxpp/article/details/51810776</p>
<hr>
<hr>
<hr>
<p>Docker 创建镜像、修改、上传镜像</p>
<p>–创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。</p>
<p>一、创建镜像</p>
<p>创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。</p>
<p>二、修改已有镜像</p>
<p>1、先使用下载的镜像启动容器。</p>
<blockquote>
<p>$ docker run -t -i training/sinatra /bin/bash <br>
root@0b2616b0e5a8:/#</p>
</blockquote>
<p>注意：记住容器的 ID，稍后还会用到。</p>
<p>2、在容器中添加 json 和 gem 两个应用。</p>
<blockquote>
<p>root@0b2616b0e5a8:/# gem install json</p>
</blockquote>
<p>当结束后，我们使用 exit 来退出，现在我们的容器已经被我们改变了，使用 docker commit 命令来提交更新后的副本。</p>
<blockquote>
<p>$ sudo docker commit -m &ldquo;Added json gem&rdquo; -a &ldquo;Docker Newbee&rdquo; 0b2616b0e5a8 ouruser/sinatra:v2 <br>
4f177bd27a9ff0f6dc2a830403925b5360bfe0b93d476f7fc3231110e7f71b1c</p>
</blockquote>
<p>其中，-m 来指定提交的说明信息，跟我们使用的版本控制工具一样；-a 可以指定更新的用户信息；之后是用来创建镜像的容器的 ID；最后指定目标镜像的仓库名和 tag 信息。创建成功后会返回这个镜像的 ID 信息。</p>
<p>使用 docker images 来查看新创建的镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">$ sudo docker images  
</span></span><span class="line"><span class="cl">REPOSITORY     TAG   IMAGE ID    CREATED    VIRTUAL SIZE  
</span></span><span class="line"><span class="cl">training/sinatra  latest 5bc342fa0b91  <span class="m">10</span> hours ago 446.7 MB  
</span></span><span class="line"><span class="cl">ouruser/sinatra   v2   3c59e02ddd1a  <span class="m">10</span> hours ago 446.7 MB  
</span></span><span class="line"><span class="cl">ouruser/sinatra   latest 5db5f8471261  <span class="m">10</span> hours ago 446.7 MB  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>之后，可以使用新的镜像来启动容器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">$ sudo docker run -t -i ouruser/sinatra:v2 /bin/bash  
</span></span><span class="line"><span class="cl">root@78e82f680994:/#  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>三、利用 Dockerfile 来创建镜像</p>
<p>使用 docker commit 来扩展一个镜像比较简单，但是不方便在一个团队中分享。我们可以使用 docker build 来创建一个新的镜像。为此，首先需要创建一个 Dockerfile，包含一些如何创建镜像的指令。<br>
新建一个目录和一个 Dockerfile</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">$ mkdir sinatra  
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> sinatra  
</span></span><span class="line"><span class="cl">$ touch Dockerfile  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>Dockerfile 中每一条指令都创建镜像的一层，例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># This is a comment  </span>
</span></span><span class="line"><span class="cl">FROM ubuntu:14.04  
</span></span><span class="line"><span class="cl">MAINTAINER Docker Newbee &lt;newbee@docker.com&gt;  
</span></span><span class="line"><span class="cl">RUN apt-get -qq update  
</span></span><span class="line"><span class="cl">RUN apt-get -qqy install ruby ruby-dev  
</span></span><span class="line"><span class="cl">RUN gem install sinatra  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>Dockerfile 基本的语法是</p>
<p>使用 # 来注释</p>
<p>FROM 指令告诉 Docker 使用哪个镜像作为基础</p>
<p>接着是维护者的信息</p>
<p>RUN 开头的指令会在创建中运行，比如安装一个软件包，在这里使用 apt-get 来安装了一些软件</p>
<p>编写完成 Dockerfile 后可以使用 docker build 来生成镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">$ sudo docker build -t<span class="o">=</span><span class="s2">&#34;ouruser/sinatra:v2&#34;</span> .  
</span></span><span class="line"><span class="cl">Uploading context 2.56 kB  
</span></span><span class="line"><span class="cl">Uploading context  
</span></span><span class="line"><span class="cl">Step <span class="m">0</span> : FROM ubuntu:14.04  
</span></span><span class="line"><span class="cl"> ---&gt; 99ec81b80c55  
</span></span><span class="line"><span class="cl">Step <span class="m">1</span> : MAINTAINER Newbee &lt;newbee@docker.com&gt;  
</span></span><span class="line"><span class="cl"> ---&gt; Running in 7c5664a8a0c1  
</span></span><span class="line"><span class="cl"> ---&gt; 2fa8ca4e2a13  
</span></span><span class="line"><span class="cl">Removing intermediate container 7c5664a8a0c1  
</span></span><span class="line"><span class="cl">Step <span class="m">2</span> : RUN apt-get -qq update  
</span></span><span class="line"><span class="cl"> ---&gt; Running in b07cc3fb4256  
</span></span><span class="line"><span class="cl"> ---&gt; 50d21070ec0c  
</span></span><span class="line"><span class="cl">Removing intermediate container b07cc3fb4256  
</span></span><span class="line"><span class="cl">Step <span class="m">3</span> : RUN apt-get -qqy install ruby ruby-dev  
</span></span><span class="line"><span class="cl"> ---&gt; Running in a5b038dd127e  
</span></span><span class="line"><span class="cl">Selecting previously unselected package libasan0:amd64.  
</span></span><span class="line"><span class="cl"><span class="o">(</span>Reading database ... <span class="m">11518</span> files and directories currently installed.<span class="o">)</span>  
</span></span><span class="line"><span class="cl">Preparing to unpack .../libasan0_4.8.2-19ubuntu1_amd64.deb ...  
</span></span><span class="line"><span class="cl">Setting up ruby <span class="o">(</span>1:1.9.3.4<span class="o">)</span> ...  
</span></span><span class="line"><span class="cl">Setting up ruby1.9.1 <span class="o">(</span>1.9.3.484-2ubuntu1<span class="o">)</span> ...  
</span></span><span class="line"><span class="cl">Processing triggers <span class="k">for</span> libc-bin <span class="o">(</span>2.19-0ubuntu6<span class="o">)</span> ...  
</span></span><span class="line"><span class="cl"> ---&gt; 2acb20f17878  
</span></span><span class="line"><span class="cl">Removing intermediate container a5b038dd127e  
</span></span><span class="line"><span class="cl">Step <span class="m">4</span> : RUN gem install sinatra  
</span></span><span class="line"><span class="cl"> ---&gt; Running in 5e9d0065c1f7  
</span></span><span class="line"><span class="cl">. . .  
</span></span><span class="line"><span class="cl">Successfully installed rack-protection-1.5.3  
</span></span><span class="line"><span class="cl">Successfully installed sinatra-1.4.5  
</span></span><span class="line"><span class="cl"><span class="m">4</span> gems installed  
</span></span><span class="line"><span class="cl"> ---&gt; 324104cde6ad  
</span></span><span class="line"><span class="cl">Removing intermediate container 5e9d0065c1f7  
</span></span><span class="line"><span class="cl">Successfully built 324104cde6ad  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>其中 -t 标记来添加 tag，指定新的镜像的用户信息。“.” 是 Dockerfile 所在的路径（当前目录），也可以替换为一个具体的 Dockerfile 的路径。</p>
<p>可以看到 build 进程在执行操作。它要做的第一件事情就是上传这个 Dockerfile 内容，因为所有的操作都要依据 Dockerfile 来进行。然后，Dockfile 中的指令被一条一条的执行。每一步都创建了一个新的容器，在容器中执行指令并提交修改（就跟之前介绍过的 docker commit 一样）。当所有的指令都执行完毕之后，返回了最终的镜像 id。所有的中间步骤所产生的容器都被删除和清理了。</p>
<p>注意一个镜像不能超过 127 层</p>
<p>此外，还可以利用 ADD 命令复制本地文件到镜像；用 EXPOSE 命令来向外部开放端口；用 CMD 命令来描述容器启动后运行的程序等。例如</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># put my local web site in myApp folder to /var/www  </span>
</span></span><span class="line"><span class="cl">ADD myApp /var/www  
</span></span><span class="line"><span class="cl"><span class="c1"># expose httpd port  </span>
</span></span><span class="line"><span class="cl">EXPOSE <span class="m">80</span>  
</span></span><span class="line"><span class="cl"><span class="c1"># the command to run  </span>
</span></span><span class="line"><span class="cl">CMD <span class="o">[</span><span class="s2">&#34;/usr/sbin/apachectl&#34;</span>, <span class="s2">&#34;-D&#34;</span>, <span class="s2">&#34;FOREGROUND&#34;</span><span class="o">]</span>  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>现在可以利用新创建的镜像来启动一个容器。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">$ sudo docker run -t -i ouruser/sinatra:v2 /bin/bash  
</span></span><span class="line"><span class="cl">root@8196968dac35:/#  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>还可以用 docker tag 命令来修改镜像的标签。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">$ sudo docker tag 5db5f8471261 ouruser/sinatra:devel  
</span></span><span class="line"><span class="cl">$ sudo docker images ouruser/sinatra  
</span></span><span class="line"><span class="cl">REPOSITORY     TAG   IMAGE ID   CREATED    VIRTUAL SIZE  
</span></span><span class="line"><span class="cl">ouruser/sinatra   latest 5db5f8471261 <span class="m">11</span> hours ago  446.7 MB  
</span></span><span class="line"><span class="cl">ouruser/sinatra   devel  5db5f8471261 <span class="m">11</span> hours ago  446.7 MB  
</span></span><span class="line"><span class="cl">ouruser/sinatra   v2   5db5f8471261 <span class="m">11</span> hours ago  446.7 MB  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>四、从本地文件系统导入</p>
<p>要从本地文件系统导入一个镜像，可以使用 openvz（容器虚拟化的先锋技术）的模板来创建：openvz 的模板下载地址为templates 。</p>
<p>比如，先下载了一个 ubuntu-14.04 的镜像，之后使用以下命令导入：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">sudo cat ubuntu-14.04-x86_64-minimal.tar.gz <span class="p">|</span>docker import - ubuntu:14.04  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>然后查看新导入的镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">docker images  
</span></span><span class="line"><span class="cl">REPOSITORY     TAG         IMAGE ID      CREATED       VIRTUAL SIZE  
</span></span><span class="line"><span class="cl">ubuntu       14.04        05ac7c0b9383    <span class="m">17</span> seconds ago   215.5 MB  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p>五、上传镜像</p>
<p>用户可以通过 docker push 命令，把自己创建的镜像上传到仓库中来共享。例如，用户在 Docker Hub 上完成注册后，可以推送自己的镜像到仓库中。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  $ sudo docker push ouruser/sinatra  
</span></span><span class="line"><span class="cl">  The push refers to a repository <span class="o">[</span>ouruser/sinatra<span class="o">]</span> <span class="o">(</span>len: 1<span class="o">)</span>  
</span></span><span class="line"><span class="cl">  Sending image list  
</span></span><span class="line"><span class="cl">  Pushing repository ouruser/sinatra <span class="o">(</span><span class="m">3</span> tags<span class="o">)</span>  
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div></article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://stc214.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://stc214.github.io/css/toc.css' />

<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://stc214.github.io/css/gitalk.css'>
<script src='https://stc214.github.io/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    clientID: 'Your client ID',
    clientSecret: 'Your client secret',
    repo: 'stc214.github.io',
    owner: 'STC214',
    admin: ['STC214'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>


  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://stc214.github.io/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://stc214.github.io/js/github-style.js"></script>




</html>